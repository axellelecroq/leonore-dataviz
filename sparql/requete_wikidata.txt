PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX p: <http://www.wikidata.org/prop/>
PREFIX ps: <http://www.wikidata.org/prop/statement/>
PREFIX pq: <http://www.wikidata.org/prop/qualifier/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bd: <http://www.bigdata.com/rdf#>

select ?nom ?leonoreid ?bnfid ?datenaissance ?ville ?datedeces ?villedc ?metier ?diplome
where {
  ?person wdt:P640 ?leonoreid;
          wdt:P1559 ?nom;
          
  OPTIONAL{?person wdt:P106 ?occupation.
           ?occupation rdfs:label ?metier
    filter (lang(?metier)="fr").}
  
  OPTIONAL{?person wdt:P268 ?bnfid.}
  
  OPTIONAL{?person wdt:P569 ?datenaissance.
           ?person wdt:P19 ?lieuNaissance.
           ?lieuNaissance rdfs:label ?ville
   filter (lang(?ville)="fr")}
  
  OPTIONAL{?person wdt:P570 ?datedeces.
           ?person wdt:P20 ?lieudeces.
           ?lieudeces rdfs:label ?villedc
    filter (lang(?villedc)="fr").}
  
  OPTIONAL{?person wdt:P512 ?niveauacademique.
           ?niveauacademique rdfs:label ?diplome
          filter (lang(?diplome)="fr").}
}



-----

Tests du nombre de résultats en fonction de ce qui est mis en optionnel :
	17814  avec tous obligatoires sauf le niveau académique et le diplome
	22005  bnfid en optionel > Certaines personnes de la base Léonore n'ont donc pas de documents à la BnF.
	22092  lieuNaissance + dateNaissance +ville en optionel
	27074  lieudeces, villedc, date deces en optionnel
-> donc vaut mieux mettre tout en optionnel sauf ?leonoreid et le ?nom afin de récupérer le plus de données

À noter : comme la plupart ont eu plusieurs métiers, il ont autant de duplicat qu'ils ont de métier 
enregistré dans wikidata. J'ai testé le distinct, ça n'a pas fait de différentes.	
	Solutions possibles : 1. faire un group by (je sais pas si ça fonctionnerait)
			      2. faire le nettoyage dans dataïku ?

